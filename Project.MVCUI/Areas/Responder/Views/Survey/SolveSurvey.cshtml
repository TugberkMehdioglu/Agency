@model SurveyViewModel

@{
    ViewData["Title"] = "SolveSurvey";
}

<div asp-validation-summary="ModelOnly" class="alert alert-danger col-sm-12 col-md-10 offset-md-1 col-lg-6 mx-lg-auto" style="padding:20px; border-radius:10px;"></div>

<div class="row border border-2 p-3" style="border-radius:20px;">
    <div class="col-sm-12 col-md-8 offset-md-2 col-lg-6 mx-lg-auto">

        <div class="text-center mb-4">
            <h3>@Model.Name Anketi</h3>
        </div>

        @{
            int questionCount = 1;
        }

        @if (Model.Questions == null || Model.Questions.Count < 1)
        {
            <h5>Anketenizde henüz soru bulunmamakta, soru eklemek için <a asp-area="Creater" asp-controller="Survey" asp-action="AddQuestionToSurvey" asp-route-surveyId="@Model.Id">tıklayınız...</a></h5>
        }
        else
        {
            <form method="post" class="text-center">



                @foreach (QuestionViewModel question in Model.Questions.Where(x => x.ParentQuestionId == null))
                {
                    <div class="border border-3 p-3 text-center shadow mb-3" style="border-radius:20px;">

                        <h3>@(questionCount))  @question.Text</h3>

                        @for (int i = 0; i < question.Answers.Count; i++)
                        {
                            <div class="form-check d-flex justify-content-center my-3">
                                <input class="form-check-input" type="radio" id="@question.Answers[i].Id" asp-for="@question.AnswrId" value="@question.Answers[i].Id">
                                <label class="form-check-label ms-2" for="@question.Answers[i].Id">
                                    @question.Answers[i].Text
                                </label>
                            </div>
                        }


                        @if (question.ChildQuestions != null && question.ChildQuestions.Count > 0)
                        {
                            <hr>
                            <h5 class="mb-3 text-success">Yukarıdaki soru cevaplandığında açılacak sorular</h5>

                            int childQuestionCount = 1;

                            @foreach (QuestionViewModel childQuestion in question.ChildQuestions)
                            {
                                <h3>@(childQuestionCount)) @childQuestion.Text</h3>

                                @for (int i = 0; i < question.Answers.Count; i++)
                                {
                                    <div class="form-check d-flex justify-content-center my-3">
                                        <input class="form-check-input" type="radio" id="@childQuestion.Answers[i].Id" asp-for="@childQuestion.AnswrId" value="@childQuestion.Answers[i].Id">
                                        <label class="form-check-label ms-2" for="@childQuestion.Answers[i].Id">
                                            @childQuestion.Answers[i].Text
                                        </label>
                                    </div>
                                }

                                ++childQuestionCount;
                            }
                        }

                    </div>

                    questionCount++;
                }

                <button type="submit" class="btn btn-outline-success mt-2 w-50 mx-auto" style="border-radius:20px;">Anketi Çöz</button>

            </form>

        }

    </div>
</div>
